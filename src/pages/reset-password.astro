---
import Layout from '@/layouts/Layout.astro';
---

<Layout title="Reset password">
  <section class="m-auto border-2 p-8 rounded-2xl max-w-md mt-10">
    <header class="mb-4">
      <h1 class="text-4xl font-bold">Reset Password</h1>
      <p>Enter your email to reset your password</p>
    </header>

    <form>
      <label for="email" class="block mb-2">
        Email
        <input
          name="email"
          type="text"
          placeholder="john@example.com"
          class="border p-2 w-full mb-4 rounded-lg"
        />
      </label>
      <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">
        Reset Password
      </button>
    </form>
  </section>
</Layout>

<script>
  import { actions } from 'astro:actions';

  const form = document.querySelector('form') as HTMLFormElement;

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const formData = new FormData(form);

    const { error } = await actions.resetPassword(formData);

    if (error) {
      alert(error.message);
      return;
    }

    alert('If an account with that email exists, a reset link has been sent.');
    form.reset();
  });
</script>
