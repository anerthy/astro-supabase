---
import Hero from '@/components/Hero.astro';
import { supabase } from '@/lib/supabase';
import Layout from '@/layouts/Layout.astro';

const { isLoggedIn, user } = Astro.locals;

if (!isLoggedIn) {
  return Astro.redirect('/sign-in');
}

const { data, error } = await supabase
  .from('teams')
  .select('*')
  .eq('owner_id', user.id);
---

<Layout title="Task Manager">
  <Hero />
  {
    data ? (
      data?.map((team) => (
        <div class="p-4 border-b">
          <h3 class="text-xl font-bold">{team.name}</h3>
          <p class="text-gray-600">{team.description}</p>
        </div>
      ))
    ) : (
      <p class="p-4">No teams found.</p>
    )
  }
</Layout>
